import{a as H,g as _,r as t,b as $,j as e,s as q,h as J,f as K,e as I,aj as Q,aS as V,aT as w,aU as D,B as N,l as T,I as E,S as X,ad as Y,p as A,V as Z}from"./index-DUvchxBs.js";import{D as ee}from"./content-DN6We_C8.js";import{C as B}from"./Card-BXPllhwE.js";import{G as F}from"./Grid-DxB7Hd2E.js";import{T as M}from"./TextField-dgsZ9ZJg.js";import{T as se}from"./TableContainer-F2VKKvRI.js";import{c as te,b as ae,T as k,a as u,d as ne}from"./TableRow-BjVrcRs8.js";import{a as oe}from"./TablePagination-Dtr3xjsv.js";import{D as re,a as ie,b as le,c as ce}from"./DialogTitle-50zJ4iux.js";import"./Select-Dyp4IxJ9.js";import"./KeyboardArrowRight-kWWu1rGt.js";import"./LastPage-BNNwMVHb.js";function de(a){return H("MuiDialogContentText",a)}_("MuiDialogContentText",["root"]);const ue=a=>{const{classes:n}=a,c=K({root:["root"]},de,n);return{...n,...c}},xe=q(I,{shouldForwardProp:a=>Q(a)||a==="classes",name:"MuiDialogContentText",slot:"Root"})({}),ge=t.forwardRef(function(n,l){const c=$({props:n,name:"MuiDialogContentText"}),{children:P,className:g,...r}=c,d=ue(r);return e.jsx(xe,{component:"p",variant:"body1",color:"textSecondary",ref:l,ownerState:r,className:J(d.root,g),...c,classes:d})});function he(){const a=Ce(),{showSnackbar:n}=V(),[l,c]=t.useState([]),[P,g]=t.useState(!0),[r,d]=t.useState(""),[C,m]=t.useState(!1),[p,j]=t.useState(null),[h,x]=t.useState(!1),[f,y]=t.useState(null),[o,i]=t.useState(""),b=t.useCallback(async()=>{try{g(!0);const s=await w.get(D.cities.list);c(s.data)}catch(s){console.error("Error fetching cities:",s),n("Failed to load cities","error")}finally{g(!1)}},[n]);t.useEffect(()=>{b()},[b]);const v=l.filter(s=>s.name.toLowerCase().includes(r.toLowerCase())),O=!v.length&&!!r,U=async()=>{if(o.trim())try{const s=await w.post(D.cities.create,{name:o.trim()});c([...l,s.data]),i(""),n("City added successfully","success")}catch(s){console.error("Error adding city:",s),n("Failed to add city","error")}else n("Please enter a city name","warning")},G=s=>{y(s),i(s.name),x(!0)},L=async()=>{if(f&&o.trim())try{const s=await w.put(D.cities.update(f.id),{name:o.trim()});c(l.map(S=>S.id===f.id?s.data:S)),i(""),x(!1),y(null),n("City updated successfully","success")}catch(s){console.error("Error updating city:",s),n("Failed to update city","error")}else o.trim()||n("Please enter a city name","warning")},W=s=>{j(s),m(!0)},z=async()=>{if(p)try{await w.delete(D.cities.delete(p)),c(l.filter(s=>s.id!==p)),m(!1),j(null),n("City deleted successfully","success")}catch(s){console.error("Error deleting city:",s),n("Failed to delete city","error")}},R=()=>{m(!1),j(null)};return e.jsxs(ee,{children:[e.jsx(N,{sx:{mb:5,display:"flex",alignItems:"center"},children:e.jsx(I,{variant:"h4",sx:{flexGrow:1},children:"Manage Cities"})}),e.jsxs(B,{sx:{mb:3,p:3},children:[e.jsx(I,{variant:"h6",sx:{mb:2},children:h?"Edit City":"Add New City"}),e.jsxs(F,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(F,{size:{xs:12,sm:6},children:e.jsx(M,{label:"City Name",variant:"outlined",value:o,onChange:s=>i(s.target.value),fullWidth:!0})}),e.jsx(F,{size:{xs:12,sm:6},children:e.jsxs(N,{sx:{display:"flex",gap:1},children:[e.jsx(T,{variant:"contained",onClick:h?L:U,startIcon:e.jsx(E,{icon:"mingcute:add-line"}),sx:{backgroundColor:"black",borderRadius:1},children:h?"Save":"Add City"}),h&&e.jsx(T,{variant:"outlined",onClick:()=>{x(!1),y(null),i("")},children:"Cancel"})]})})]})]}),e.jsxs(B,{children:[e.jsx(N,{sx:{p:3},children:e.jsx(M,{label:"Search City",variant:"outlined",fullWidth:!0,value:r,onChange:s=>d(s.target.value),sx:{mb:2}})}),e.jsx(X,{children:e.jsx(se,{sx:{overflow:"unset"},children:e.jsxs(te,{sx:{minWidth:800},children:[e.jsx(ae,{children:e.jsxs(k,{children:[e.jsx(u,{children:"S.No"}),e.jsx(u,{children:"City Name"}),e.jsx(u,{children:"Actions"})]})}),e.jsx(ne,{children:P?e.jsx(k,{children:e.jsx(u,{colSpan:3,sx:{textAlign:"center",py:3},children:e.jsx(Y,{})})}):e.jsxs(e.Fragment,{children:[v.slice(a.page*a.rowsPerPage,a.page*a.rowsPerPage+a.rowsPerPage).map((s,S)=>e.jsxs(k,{children:[e.jsx(u,{children:a.page*a.rowsPerPage+S+1}),e.jsx(u,{children:s.name}),e.jsxs(u,{children:[e.jsx(A,{onClick:()=>G(s),children:e.jsx(E,{icon:"solar:pen-bold"})}),e.jsx(A,{onClick:()=>W(s.id),children:e.jsx(E,{icon:"solar:trash-bin-trash-bold"})})]})]},s.id)),O&&e.jsx(k,{children:e.jsx(u,{colSpan:3,sx:{textAlign:"center"},children:"No cities found"})})]})})]})})}),e.jsx(oe,{component:"div",page:a.page,count:v.length,rowsPerPage:a.rowsPerPage,onPageChange:a.onChangePage,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:a.onChangeRowsPerPage})]}),e.jsxs(re,{open:C,onClose:R,children:[e.jsx(ie,{children:"Confirm Delete"}),e.jsx(le,{children:e.jsx(ge,{children:"Are you sure you want to delete this city?"})}),e.jsxs(ce,{children:[e.jsx(T,{onClick:R,children:"Cancel"}),e.jsx(T,{onClick:z,color:"error",variant:"contained",children:"Delete"})]})]})]})}function Ce(){const[a,n]=t.useState(0),[l,c]=t.useState("name"),[P,g]=t.useState(5),[r,d]=t.useState([]),[C,m]=t.useState("asc"),p=t.useCallback(o=>{m(l===o&&C==="asc"?"desc":"asc"),c(o)},[C,l]),j=t.useCallback((o,i)=>{if(o){d(i);return}d([])},[]),h=t.useCallback(o=>{const i=r.includes(o)?r.filter(b=>b!==o):[...r,o];d(i)},[r]),x=t.useCallback(()=>{n(0)},[]),f=t.useCallback((o,i)=>{n(i)},[]),y=t.useCallback(o=>{g(parseInt(o.target.value,10)),x()},[x]);return{page:a,order:C,onSort:p,orderBy:l,selected:r,rowsPerPage:P,onSelectRow:h,onResetPage:x,onChangePage:f,onSelectAllRows:j,onChangeRowsPerPage:y}}function ve(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:`Cities - ${Z.appName}`}),e.jsx(he,{})]})}export{ve as default};
