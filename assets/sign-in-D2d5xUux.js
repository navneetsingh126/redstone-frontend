import{j as e,B as d,ad as I,e as m,ab as S,ae as v,r as a,af as C,ag as P,a7 as L,p as k,I as A,l as F,V as B}from"./index-CbRCKR0p.js";import{T as p}from"./TextField-D4SQiBIy.js";import"./Select-DPM53_uB.js";function z({message:r="Loading...",fullScreen:i=!0}){return e.jsxs(d,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:2,...i&&{height:"100vh",width:"100vw"}},children:[e.jsx(I,{size:40}),e.jsx(m,{variant:"body2",color:"text.secondary",children:r})]})}function D(){const r=S(),{login:i,isAuthenticated:u,isInitialized:f}=v(),[o,j]=a.useState(!1),[s,c]=a.useState({username:"",password:""}),[x,l]=a.useState(null),[h,g]=a.useState(!1),y=a.useCallback(async()=>{var n,t;if(!s.username||!s.password){l("Please enter both username and password");return}try{g(!0),l(null),await i(s),r.push("/user")}catch(b){l(((t=(n=b.response)==null?void 0:n.data)==null?void 0:t.detail)||"Login failed. Please try again.")}finally{g(!1)}},[s,i,r]);if(!f)return e.jsx(z,{message:"Checking authentication..."});if(u)return e.jsx(C,{to:"/user",replace:!0});const w=e.jsxs(d,{sx:{display:"flex",alignItems:"flex-end",flexDirection:"column"},children:[x&&e.jsx(P,{severity:"error",sx:{mb:3,width:"100%"},children:x}),e.jsx(p,{fullWidth:!0,name:"username",label:"Username",value:s.username,onChange:n=>c(t=>({...t,username:n.target.value})),sx:{mb:3},slotProps:{inputLabel:{shrink:!0}}}),e.jsx(p,{fullWidth:!0,name:"password",label:"Password",type:o?"text":"password",value:s.password,onChange:n=>c(t=>({...t,password:n.target.value})),slotProps:{inputLabel:{shrink:!0},input:{endAdornment:e.jsx(L,{position:"end",children:e.jsx(k,{onClick:()=>j(!o),edge:"end",children:e.jsx(A,{icon:o?"solar:eye-bold":"solar:eye-closed-bold"})})})}},sx:{mb:3}}),e.jsx(F,{fullWidth:!0,size:"large",type:"submit",color:"inherit",variant:"contained",onClick:y,disabled:h,children:h?"Signing in...":"Sign in"})]});return e.jsxs(e.Fragment,{children:[e.jsx(d,{sx:{gap:1.5,display:"flex",flexDirection:"column",alignItems:"center",mb:5},children:e.jsx(m,{variant:"h5",children:"Sign in"})}),w]})}function W(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:`Sign in - ${B.appName}`}),e.jsx(D,{})]})}export{W as default};
